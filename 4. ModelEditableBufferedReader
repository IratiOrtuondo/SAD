package MVC;

public class TextModel {
    private StringBuilder buffer;
    private int cursorPos;
    private boolean insertMode;

    public TextModel() {
        buffer = new StringBuilder();
        cursorPos = 0;
        insertMode = true;
    }

    public void insertChar(char c) {
        if (insertMode) {
            buffer.insert(cursorPos, c);
        } else {
            if (cursorPos < buffer.length()) {
                buffer.setCharAt(cursorPos, c);
            } else {
                buffer.insert(cursorPos, c);
            }
        }
        cursorPos++;
    }

    public void deleteChar() {
        if (cursorPos > 0) {
            buffer.deleteCharAt(cursorPos - 1);
            cursorPos--;
        }
    }

    public void deleteCurrentChar() {
        if (cursorPos < buffer.length()) {
            buffer.deleteCharAt(cursorPos);
        }
    }

    public void moveCursorLeft() {
        if (cursorPos > 0) cursorPos--;
    }

    public void moveCursorRight() {
        if (cursorPos < buffer.length()) cursorPos++;
    }

    public void moveCursorHome() {
        cursorPos = 0;
    }

    public void moveCursorEnd() {
        cursorPos = buffer.length();
    }

    public void toggleInsertMode() {
        insertMode = !insertMode;
    }

    public String getText() {
        return buffer.toString();
    }

    public int getCursorPos() {
        return cursorPos;
    }

    public boolean isInsertMode() {
        return insertMode;
    }
}
